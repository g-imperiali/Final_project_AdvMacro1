


\section{Model Setup}
[\textit{The following has been written and derived by Grace -- July 16, 2025}]
\subsection{Environment}

\subsection{Preferences}

CHANGE TO STANDARD REPRESENTATIVE HOUSEHOLD\\

The representative household chooses consumption and its supply of high-skilled and low-skilled labor. Let $\eta$ be the elasticity of goods $i$ within a market and $\theta$ the elasticity of goods across markets $j$. $\eta > \theta$ because goods within the market are more substitutable than goods across. \\

For the labor market, let $\{\hat{\eta}_L, \hat{\eta}_H\}$ and $\{\hat{\theta}_L,\hat{\theta}_H\} $ be the elasticities of substitution for low-skilled and high-skilled laborers respectively within and across markets. Similarly, $\hat{\eta}_S > \hat{\theta}_S, \forall S \in \{L,H\}$.

\begin{align}
    \text{max}_{C_{inj}, L_{inj}, H_{inj}} \hspace{0.2 cm} C - \frac{1}{\phi_L^{-\frac{1}{\phi_L}}}\frac{L^{\frac{\phi_L +1}{\phi_L}}}{\frac{\phi_L +1}{\phi_L}} - \frac{1}{\phi_H^{-\frac{1}{\phi_H}}}\frac{H^{\frac{\phi_H +1}{\phi_H}}}{\frac{\phi_H +1}{\phi_H}} \\
    \text{s.t.} \hspace{0.2 cm} PC =LW_L+HW_H+\Pi
\end{align}

where $C, H, and L$ are the CES indices for aggregate consumption and employment of
high- and low-skilled workers. $P, W_H,$ and $ W_L $are the CES aggregated indices for prices and wages. 

\begin{align}
    C = (\int_j J^{-\frac{1}{\theta}} C_j^{\frac{\theta-1}{\theta}}dj)^{\frac{\theta}{\theta-1}} \\
    C_j = (\sum_i I^{-\frac{1}{\eta}} C_{inj}^{\frac{\eta-1}{\eta}})^{\frac{\eta}{\eta-1}} \\
    S = (\int_j J^{\frac{1}{\hat{\theta}_S}} C_j^{\frac{\hat{\theta}_S-1}{\hat{\theta}_S}}dj)^{\frac{\hat{\theta}_S}{\hat{\theta}_S-1}} \\
    S_j = (\sum_i I^{\frac{1}{\hat{\eta_S}}} C_{inj}^{\frac{\hat{\eta_S}+1}{\hat{\eta_S}}})^{\frac{\hat{\eta_S}}{\hat{\eta_S}+1}} \\
    , \forall S \in \{H,L\}
\end{align}


\subsection{Technology}

% \begin{align}
%     Y_{inj} = [(A_{Linj}L_{inj})^{\frac{\sigma-1}{\sigma}} + (A_{Hinj}H_{inj})^{\frac{\sigma-1}{\sigma}}]^{\frac{\sigma}{\sigma-1}}
% \end{align}

\begin{align}
    y_i(s) = z_i(s) l_i(s)
\end{align}

\section{Key Equations}

\subsection{Firm demand and supply curves}

\begin{align}
p_i(s) = (\frac{y_i(s)}{y(s)})^{-\frac{1}{\eta}}(\frac{y(s)}{Y})^{-\frac{1}{\theta}}P\\
y_i(s) = (\frac{p_i(s)}{p(s)})^{-\eta}(\frac{p(s)}{P})^{-\theta}Y\\
    W_i(s) = (\frac{L_i(s)}{L(s)})^{\frac{1}{\hat{\eta}}}(\frac{L(s)}{L})^{\frac{1}{\hat{\theta}}} W\\
    L_i(s) = (\frac{W_i(s)}{W(s)})^{\hat{\eta}}(\frac{W(s)}{W})^{\hat{\theta}} L\\
     % W^H_i(s) = (\frac{H_i(s)}{H(s)})^{\frac{1}{\hat{\eta}_H}}(\frac{H(s)}{H})^{\frac{1}{\hat{\theta}_H}} W_H\\
     % H_i(s) = (\frac{W^H_i(s)}{W^H(s)})^{\hat{\eta}_H}(\frac{W^H(s)}{W^H})^{\hat{\theta}_H} H\\
\end{align}

\subsection{Pricing}

\begin{align}
    p_i(s) = \frac{\epsilon_i^P(s)}{\epsilon_i^P(s)-1} \frac{W }{z_i(s)}(1+\frac{1}{\epsilon_i^S(s)})
\end{align}
s.t. $\epsilon_i^P(s)$ is the demand elasticity and $\epsilon_i^S(s)$ is the supply elasticity of laborer $S \in \{L,H\}$.\\

Demand elasticity and labor elasticity are decreasing in market and labor shares,\\
\begin{align}
    \epsilon_i^P(s) = (\omega_i(s)\frac{1}{\theta} + (1-\omega_i(s))\frac{1}{\eta})^{-1}\\
    \epsilon^W_i(s) =  (\alpha_i(s)\frac{1}{\hat{\theta}} + (1-\alpha_i(s))\frac{1}{\hat{\eta}})^{-1}
\end{align}

\subsection{Market share and Labor share}

Let $W^L_i(s) = L_i(s)^{\frac{1}{\hat{\eta}}}\underbrace{\frac{1}{L(s)}^{\frac{1}{\hat{\eta}}}(\frac{L(s)}{L})^{\frac{1}{\hat{\theta}}} W_L}_{C_W(s)} = L_i(s)^{\frac{1}{\hat{\eta}}} C_W(s)$ and $y_i(s) = p_i(s)^{-\eta}\underbrace{\frac{1}{p(s)}^{\eta}(\frac{p(s)}{P})^{-\theta}Y}_{C_y(s)}\\$

\begin{align}
    p_i(s) &= W_i(s)\delta_i(s)\frac{\mu_i(s)}{z_i(s)}\\
    %y_i(s) p_i(s) &= W_i(s)\delta_i(s)\frac{\mu_i(s)}{z_i(s)}y_i(s)\\
    &= L_i(s)^{\frac{1}{\hat{\eta}}} C_W(s)\delta_i(s)\frac{\mu_i(s)}{z_i(s)}\\
    &= (\frac{y_i(s)}{z_i(s)})^{\frac{1}{\hat{\eta}}} C_W(s)\delta_i(s)\frac{\mu_i(s)}{z_i(s)}\\
    &= C_W(s) C_y(s)^{\frac{1}{\hat{\eta}}} (\frac{p_i(s)^{-\eta}}{z_i(s)})^{\frac{1}{\hat{\eta}}} \delta_i(s)\frac{\mu_i(s)}{z_i(s)}\\
    p_i(s)^{1+\frac{\eta}{ \hat{\eta}}} &=  C_W(s) C_y(s)^{\frac{1}{\hat{\eta}}} \delta_i(s)z_i(s)^{-\frac{1}{ \hat{\eta}}-1}\mu_i(s)\\
    p_i(s) &=  [C_W(s) C_y(s)^{\frac{1}{\hat{\eta}}} \delta_i(s)z_i(s)^{-\frac{1}{ \hat{\eta}}-1}\mu_i(s)]^{\frac{ \hat{\eta}}{\eta+\hat{\eta}}}\\
    y_i(s)p_i(s) &= p_i(s)^{1-\eta} = [C_W(s) C_y(s)^{\frac{1}{\hat{\eta}}} \delta_i(s)z_i(s)^{-\frac{1}{ \hat{\eta}}-1}\mu_i(s)]^{\frac{\hat{\eta}(1-\eta)}{\eta+\hat{\eta}}}\\
    \sum_i^{n(s)} y_i(s) p_i(s) &= (C_W(s) C_y(s)^{\frac{1}{\hat{\eta}}})^{\frac{\hat{\eta}(1-\eta)}{\eta+\hat{\eta}}}\sum_i^{n(s)} [\delta_i(s)z_i(s)^{-\frac{1}{ \hat{\eta}}-1}\mu_i(s)]^{\frac{\hat{\eta}(1-\eta)}{\eta+\hat{\eta}}}\\
    \omega_i(s) &= \frac{p_i(s) y_i(s)}{\sum_i^{n(s)} y_i(s) p_i(s)} =  \frac{[\delta_i(s)z_i(s)^{-\frac{1}{ \hat{\eta}}-1}\mu_i(s)]^{\frac{\hat{\eta}(1-\eta)}{\eta+\hat{\eta}}}}{\sum_i^{n(s)} [\delta_i(s)z_i(s)^{-\frac{1}{ \hat{\eta}}-1}\mu_i(s)]^{\frac{\hat{\eta}(1-\eta)}{\eta+\hat{\eta}}}}
\end{align}
\newpage
Let $p_i(s) = y_i(s)^{-\frac{1}{\eta}}\underbrace{(\frac{1}{y(s)})^{-\frac{1}{\eta}}(\frac{y(s)}{Y})^{-\frac{1}{\theta}}P}_{C_p(s)}$ and $L_i(s) = W_i(s)^{\hat{\eta}} C_L(s)$

\begin{align}
    W_i(s) &= \frac{p_i(s)z_i(s)}{\delta_i(s)\mu_i(s)}\\
    &= y_i(s)^{-\frac{1}{\eta}} \frac{C_p(s) z_i(s)}{\delta_i(s)\mu_i(s)}\\
    &= (z_i(s)L_i(s))^{-\frac{1}{\eta}}\frac{C_p(s) z_i(s)}{\delta_i(s)\mu_i(s)}\\
    &= (z_i(s) W_i(s)^{\hat{\eta}} C_L(s))^{-\frac{1}{\eta}}\frac{C_p(s) z_i(s)}{\delta_i(s)\mu_i(s)}\\
    W_i(s)^{1+\frac{\hat{\eta}}{\eta}} &= z_i(s)^{-\frac{1}{\eta}+1}C_L(s)^{-\frac{1}{\eta}}C_p(s) \delta_i(s)^{-1}\mu_i(s)^{-1}\\
    W_i(s) &= [z_i(s)^{-\frac{1}{\eta}+1}C_L(s)^{-\frac{1}{\eta}}C_p(s) \delta_i(s)^{-1}\mu_i(s)^{-1}]^{\frac{\eta}{\eta+\hat{\eta}}}\\
    W_i(s) L_i(s) &= W_i(s)^{1+\hat{\eta}}= [z_i(s)^{-\frac{1}{\eta}+1}C_L(s)^{-\frac{1}{\eta}}C_p(s) \delta_i(s)^{-1}\mu_i(s)^{-1}]^{\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}}\\
    \sum_i^{n(s)}W_i(s) L_i(s) &= (C_L(s)^{-\frac{1}{\eta}}C_p(s))^{\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}} \sum_i^{n(s)} [z_i(s)^{-\frac{1}{\eta}+1}\delta_i(s)^{-1}\mu_i(s)^{-1}]^{\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}}  \\
    &= (C_L(s)^{-\frac{1}{\eta}}C_p(s))^{\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}} \sum_i^{n(s)} [z_i(s)^{\frac{1}{\eta}-1}\delta_i(s)\mu_i(s)]^{-\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}}\\
    \alpha_i(s) &= \frac{W_i(s) L_i(s)}{\sum_i^{n(s)}W_i(s) L_i(s)}=\frac{[z_i(s)^{\frac{1}{\eta}-1}\delta_i(s)\mu_i(s)]^{-\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}}}{\sum_i^{n(s)} [z_i(s)^{\frac{1}{\eta}-1}\delta_i(s)\mu_i(s)]^{-\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}}}
\end{align}

% \begin{align}
%     \omega_i(s) = (\frac{p_i(s)}{p(s)})^{1-\eta} = \frac{[W^S_i(s)\delta^S_i(s) \mu_i(s)]^{1-\eta}z_i(s)^{\eta-1}}{\sum_{i}^{n(s)} [W^S_i(s)\delta^S_i(s) \mu_i(s)]^{1-\eta}z_i(s)^{\eta-1}}\\
%     \alpha_i(s) = (\frac{W^S_i(s)}{W^S(s)})^{1+\hat{\eta}} = \frac{(p_i(s)z_i(s))^{1+\hat{\eta}}(\delta_i(s)\mu_i(s))^{\hat{\eta}-1}}{\sum_{i}^{n(s)}(p_i(s)z_i(s))^{1+\hat{\eta}}(\delta_i(s)\mu_i(s))^{\hat{\eta}-1}}
% \end{align}

%Goal: get 2n equations and 2n unknowns to adapt the algorithm, we have markdowns as well now


\section{Solving for Industry Equilibrium}

\begin{align}
    1-\frac{1}{\mu_i(s)} = \frac{1}{\epsilon^P_i(s)} = \frac{1}{\eta} + (\frac{1}{\theta} - \frac{1}{\eta} )\omega_i(s)\\
    \delta_i(s) - 1 = \frac{1}{\epsilon^W_i(s)} = \frac{1}{\hat{\eta}} + (\frac{1}{\hat{\theta}} - \frac{1}{\hat{\eta}} )\alpha_i(s)
\end{align}

\subsection{Proposed Algorithm}
\begin{enumerate}
    \item Define aggregates $D_1(s)$ and $D_2(s)$ to go with equations (27) and (37)
    \begin{align}
        \omega_i(s) = \frac{[\delta_i(s)z_i(s)^{-\frac{1}{ \hat{\eta}}-1}\mu_i(s)]^{\frac{\hat{\eta}(1-\eta)}{\eta+\hat{\eta}}}}{\sum_i^{n(s)} [\delta_i(s)z_i(s)^{-\frac{1}{ \hat{\eta}}-1}\mu_i(s)]^{\frac{\hat{\eta}(1-\eta)}{\eta+\hat{\eta}}}}\\
        D_1(s) = (\sum_i^{n(s)} [\delta_i(s)z_i(s)^{-\frac{1}{ \hat{\eta}}-1}\mu_i(s)]^{\frac{\hat{\eta}(1-\eta)}{\eta+\hat{\eta}}})^{\frac{\eta+\hat{\eta}  }{\hat{\eta}(1-\eta)}}\\
        \alpha_i(s)  =\frac{[z_i(s)^{\frac{1}{\eta}-1}\delta_i(s)\mu_i(s)]^{-\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}}}{\sum_i^{n(s)} [z_i(s)^{\frac{1}{\eta}-1}\delta_i(s)\mu_i(s)]^{-\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}}}\\
        D_2(s) = (\sum_i^{n(s)} [z_i(s)^{\frac{1}{\eta}-1}\delta_i(s)\mu_i(s)]^{-\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}})^{-\frac{\eta+\hat{\eta}}{\eta(\hat{\eta}+1)}}
    \end{align}
    \item Define $x_i(s)$ and $g_i(s)$ s.t. $x_i(s)$ is a function of $D_1(s)$ and $\delta_i(s)$; $g_i(s)$ is a function of $D_2(s)$ and $\mu_i(s)$
    \begin{align}
        x_i(s) = (\frac{\delta_i(s) z_i(s)^{-\frac{1}{\hat{\eta}}-1}}{D_1(s)})^{\frac{\hat{\eta}(1-\eta)}{\eta + \hat{\eta}}}\\
        g_i(s) = (\frac{\mu_i(s) z_i(s)^{\frac{1}{\eta}-1}}{D_2(s)})^{-\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}}
    \end{align}
    \item Solve for $x(\mu)$ for $\mu \in [a_1,b_1]$ interpolate retrieving function $U(x)$
    \begin{align}
    1- \frac{1}{\mu_i(s)}   = \frac{1}{\eta} + (\frac{1}{\theta} - \frac{1}{\eta} )\mu_i(s)^{\frac{\hat{\eta}(1-\eta)}{\eta + \hat{\eta}}} x_i(s)
    \end{align}
    \item Solve for $g(\delta)$ for $\delta \in [a_2,b_2]$ interpolate retrieving function $\Delta(g)$
    \begin{align}
        \delta_i(s)-1   = \frac{1}{\hat{\eta}} + (\frac{1}{\hat{\theta}} - \frac{1}{\hat{\eta}} )\delta_i(s)^{-\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}} g_i(s)
    \end{align}
    \item Iteration:
    \begin{enumerate}
        \item Guess a vector of \textcolor{red}{$\delta_i(s)$}
        \item Solve for \textcolor{darkgreen}{$D_1(s)$}
        \begin{align}
        \textcolor{darkgreen}{D_1(s)} = (\sum_i^{n(s)} [\textcolor{red}{\delta_i(s)} z_i(s)^{-\frac{1}{ \hat{\eta}}-1}U((\frac{\textcolor{red}{\delta_i(s)} z_i(s)^{-\frac{1}{\hat{\eta}}-1}}{\textcolor{darkgreen}{D_1(s)}})^{\frac{\hat{\eta}(1-\eta)}{\eta + \hat{\eta}}})]^{\frac{\hat{\eta}(1-\eta)}{\eta+\hat{\eta}}})^{\frac{\eta+\hat{\eta}  }{\hat{\eta}(1-\eta)}}
    \end{align}
        \item Calculate $x_i(s)$ and then $\mu_i(s)$.
    \item Use \textcolor{blue}{$\mu_i(s)$} to solve for \textcolor{melon}{$D_2(s)$}. 
    \begin{align}
         \textcolor{melon}{D_2(s)} = (\sum_i^{n(s)} [z_i(s)^{\frac{1}{\eta}-1}\Delta((\frac{\textcolor{blue}{\mu_i(s)} z_i(s)^{\frac{1}{\eta}-1}}{\textcolor{melon}{D_2(s)}})^{-\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}})\textcolor{blue}{\mu_i(s)}]^{-\frac{\eta(\hat{\eta}+1)}{\eta+\hat{\eta}}})^{-\frac{\eta+\hat{\eta}}{\eta(\hat{\eta}+1)}}
    \end{align}
    \item Calculate $g_i(s)$ and $\delta_i(s)$
    \item Compare resulting $\delta_i(s)$ with initial guess 
    \item Iterate until $\delta_i(s)$ converges
    \end{enumerate}
\end{enumerate}

\section{Aggregation}


\section{Numerical Results}

% Compare markups with and without labor market power -> latter should exacerbate the former

% Look at distribution of skill premium like in the paper

% compare skill premium without frictions to get a measure of "efficient" inequality

% Aggregate welfare analysis



\section{Main Contributions}

% 1. Technical: if we can get a better/faster algorithm like in lecture to solve the equilibrium

% 2. Possible extensions
% - Include competitive sectors in addition to concentrated ones (unrealistic to say all sectors have market power)
% - crazy: should we add occupational choice... (?) 

% 3. TBH - the motivation of this paper is questionable. It is not clear at all why you need both product market power and labor market power to answer how the skill premium changes in the first place. To me, it makes more sense to do labor market power + skill heterogenity and thats it. Should we do this counterfactual exercise ??

% 4. Can the production function be simplified? so that the algorithm works better? perhaps firms can only employ low-skilled or high-skilled while high-skilled has a higher productivity -> task-based production functions? 
